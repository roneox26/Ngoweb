<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    @media print {
      .no-print { display: none; }
      body { font-size: 10px; }
    }
    table { font-size: 11px; }
    th, td { padding: 3px !important; white-space: nowrap; }
    .weekend { background-color: #ffe6e6 !important; }
  </style>
</head>

<body class="container-fluid mt-3">
  <div class="no-print mb-3">
    <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">‚¨ÖÔ∏è Back</a>
    <button onclick="window.print()" class="btn btn-primary">üñ®Ô∏è Print</button>
  </div>

  <div class="text-center mb-3">
    <h4>‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶Ü‡¶∞‡ßç‡¶•‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</h4>
    <p>‡¶Æ‡¶æ‡¶∏: {{ month_name|default('') }} {{ year|default('') }}</p>
  </div>

  <div class="table-responsive">
    <table class="table table-bordered table-sm">
      <thead class="table-dark">
        <tr>
          <th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th>
          <th>‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º</th>
          <th>‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø</th>
          <th>‡¶ï‡¶≤‡ßç‡¶Ø‡¶æ‡¶£ ‡¶´‡¶ø</th>
          <th>‡¶≠‡¶∞‡ßç‡¶§‡¶ø ‡¶´‡¶ø</th>
          <th>‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶´‡¶ø</th>
          <th>‡¶Æ‡ßÇ‡¶≤‡¶ß‡¶® ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º</th>
          <th>‡¶≤‡ßã‡¶® ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®</th>
          <th>‡¶≤‡¶æ‡¶≠</th>
          <th>‡¶≤‡¶æ‡¶≠‡ßç‡¶Ø‡¶æ‡¶Ç‡¶∂ ‡¶∏‡¶π ‡¶≤‡ßã‡¶®</th>
          <th>‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º ‡¶´‡ßá‡¶∞‡¶§</th>
          <th>‡¶ñ‡¶∞‡¶ö</th>
          <th>‡¶Æ‡ßã‡¶ü ‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º</th>
          <th>‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</th>
        </tr>
      </thead>
      <tbody>
        {% if daily_data %}
        {% for day in range(1, (last_day|default(31)) + 1) %}
        {% set day_data = daily_data.get(day, {}) %}
        <tr {% if day_data.get('is_weekend', False) %}class="weekend"{% endif %}>
          <td>{{ day }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('savings', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('installments', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('welfare_fee', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('admission_fee', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('service_charge', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('capital_savings', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('loan_given', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('interest', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('loan_with_interest', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('savings_return', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('expenses', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('total_expense', 0)) }}</td>
          <td class="text-end"><strong>{{ "{:,.0f}".format(day_data.get('balance', 0)) }}</strong></td>
        </tr>
        {% endfor %}
        {% else %}
        <tr>
          <td colspan="14" class="text-center">‡¶ï‡ßã‡¶®‡ßã ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡ßá‡¶á</td>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </div>

  <!-- Summary Section -->
  <div class="mt-4">
    <h5 class="text-center">‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ / Monthly Summary</h5>
    <table class="table table-bordered table-sm mt-3">
      <tbody>
        <tr class="table-info">
          <td><strong>‡¶Æ‡ßã‡¶ü ‡¶Æ‡ßÇ‡¶≤‡¶ß‡¶® ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º / Total Capital Savings:</strong></td>
          <td class="text-end"><strong>‡ß≥{{ "{:,.0f}".format(total_capital_savings|default(0)) }}</strong></td>
        </tr>
        <tr class="table-warning">
          <td><strong>‡¶Æ‡ßã‡¶ü ‡¶≤‡ßã‡¶® ‡¶¨‡¶ø‡¶§‡¶∞‡¶£ / Total Loan Distributed:</strong></td>
          <td class="text-end"><strong>‡ß≥{{ "{:,.0f}".format(total_loan_distributed|default(0)) }}</strong></td>
        </tr>
        <tr>
          <td>‡¶Æ‡ßÇ‡¶≤‡¶ß‡¶® ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º / Capital Savings:</td>
          <td class="text-end">‡ß≥{{ "{:,.0f}".format(total_capital_savings|default(0)) }}</td>
        </tr>
        <tr class="table-success">
          <td><strong>‡¶≤‡¶æ‡¶≠‡ßç‡¶Ø‡¶æ‡¶Ç‡¶∂ / Interest:</strong></td>
          <td class="text-end"><strong>‡ß≥{{ "{:,.0f}".format(total_interest|default(0)) }}</strong></td>
        </tr>
        <tr class="table-light">
          <td>‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶¨‡¶ï‡ßá‡¶Ø‡¶º‡¶æ / Previous Outstanding:</td>
          <td class="text-end">‡ß≥{{ "{:,.0f}".format(prev_remaining|default(0)) }}</td>
        </tr>
        <tr class="table-warning">
          <td><strong>‡¶Æ‡ßã‡¶ü ‡¶¨‡¶ï‡ßá‡¶Ø‡¶º‡¶æ / Total Outstanding:</strong></td>
          <td class="text-end"><strong>‡ß≥{{ "{:,.0f}".format(current_remaining|default(0)) }}</strong></td>
        </tr>
        <tr>
          <td>‡¶ñ‡¶∞‡¶ö / Expenses:</td>
          <td class="text-end">‡ß≥{{ "{:,.0f}".format(total_monthly_expenses|default(0)) }}</td>
        </tr>
        <tr class="table-danger">
          <td><strong>‡¶Æ‡ßã‡¶ü ‡¶ñ‡¶∞‡¶ö / Total Expenses:</strong></td>
          <td class="text-end"><strong>‡ß≥{{ "{:,.0f}".format(total_monthly_expenses|default(0)) }}</strong></td>
        </tr>
      </tbody>
    </table>
  </div>
</body>
</html>
